{"version":3,"sources":["webpack:///src/app/search/search.page.html","webpack:///src/app/search/search-routing.module.ts","webpack:///src/app/search/search.module.ts","webpack:///src/app/search/search.page.scss","webpack:///src/app/search/search.page.ts"],"names":["routes","path","component","SearchPageRoutingModule","imports","forChild","exports","SearchPageModule","declarations","SearchPage","http","navCtrl","route","router","formBuilder","criteria","numres","isSubmitted","formcriteria","tipo","campo","valor","group","required","valid","console","log","value","i","find","e","p","push","a","splice","findIndex","o","getItemType","e1","e2","id","c","searchEditions","subscribe","res","items","error","controls","selector","template"],"mappings":"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","file":"search-search-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"explore\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title>Búsqueda avanzada</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding [fullscreen]=\\\"true\\\">\\n  <form [formGroup]=\\\"formcriteria\\\" (ngSubmit)=\\\"addCriteria()\\\" novalidate>\\n    <ion-list>\\n      <ion-item lines=\\\"full\\\">\\n        <ion-label position=\\\"stacked\\\">Selecciona tipo de ítem</ion-label>\\n        <ion-select okText=\\\"Aceptar\\\" cancelText=\\\"Cancelar\\\" interface=\\\"alert\\\" placeholder=\\\"Seleccionar\\\" \\n        formControlName=\\\"tipo\\\" type=\\\"text\\\" (ionChange)=\\\"changeType()\\\">\\n          <ion-select-option value=\\\"all\\\">Todos</ion-select-option>\\n          <ion-select-option value=\\\"book\\\">Libro</ion-select-option>\\n          <ion-select-option value=\\\"music\\\">Música</ion-select-option>\\n          <ion-select-option value=\\\"video\\\">Vídeo</ion-select-option>\\n          <ion-select-option value=\\\"game\\\">Videojuego</ion-select-option>\\n          <ion-select-option value=\\\"comic\\\">Comic</ion-select-option>\\n        </ion-select>\\n      </ion-item>\\n      <ion-item lines=\\\"full\\\">\\n        <small>Asigna al menos un criterio de búsqueda:</small>\\n      </ion-item>\\n      <ion-item lines=\\\"full\\\">\\n        <ion-select okText=\\\"Aceptar\\\" cancelText=\\\"Cancelar\\\" interface=\\\"alert\\\" placeholder=\\\"Campo\\\" \\n        formControlName=\\\"campo\\\" type=\\\"text\\\">\\n          <ion-select-option value=\\\"ItemName\\\">Título</ion-select-option>\\n          <ion-select-option value=\\\"Year\\\">Año de edición</ion-select-option>\\n          <ion-select-option value=\\\"EAN13\\\">EAN13</ion-select-option>\\n          <!--<ion-select-option *ngFor=\\\"let d of campos2\\\" [value]=\\\"d.campo\\\">{{d.nombre}}</ion-select-option>-->\\n          <div *ngIf=\\\"formcriteria.value['tipo']=='book'\\\">\\n            <ion-select-option value=\\\"ISBN\\\">ISBN</ion-select-option>\\n            <ion-select-option value=\\\"Editorial\\\">Editorial</ion-select-option>\\n            <ion-select-option value=\\\"Idioma\\\">Idioma</ion-select-option>\\n            <ion-select-option value=\\\"Tipo\\\">Tipo (bolsillo, tapa dura, ebook...)</ion-select-option>\\n          </div>\\n          <div *ngIf=\\\"formcriteria.value['tipo']=='music'\\\">\\n            <ion-select-option value=\\\"Formato\\\">Formato (CD, vinilo, digital...)</ion-select-option>\\n            <ion-select-option value=\\\"Sello\\\">Sello</ion-select-option>\\n          </div>\\n          <div *ngIf=\\\"formcriteria.value['tipo']=='video'\\\">\\n            <ion-select-option value=\\\"FormatoVideo\\\">Formato (DVD, Bluray...)</ion-select-option>\\n            <ion-select-option value=\\\"TipoVideo\\\">Tipo (Película, serie...)</ion-select-option>\\n            <ion-select-option value=\\\"Sistema\\\">Sistema (PAL, NTSC...)</ion-select-option>\\n            <ion-select-option value=\\\"RegionVideo\\\">Región</ion-select-option>\\n            <ion-select-option value=\\\"Temporada\\\">Temporada</ion-select-option>\\n          </div>\\n          <div *ngIf=\\\"formcriteria.value['tipo']=='game'\\\">\\n            <ion-select-option value=\\\"Plataforma\\\">Plataforma/consola</ion-select-option>\\n            <ion-select-option value=\\\"FormatoJuego\\\">Formato (físico/digital...)</ion-select-option>\\n            <ion-select-option value=\\\"RegionJuego\\\">Región</ion-select-option>\\n            <ion-select-option value=\\\"Distribuidora\\\">Distribuidora</ion-select-option>\\n            <ion-select-option value=\\\"Estudio\\\">Estudio</ion-select-option>\\n          </div>\\n          <div *ngIf=\\\"formcriteria.value['tipo']=='comic'\\\">\\n            <ion-select-option value=\\\"TipoComic\\\">Tipo (grapas, tomo, omnibus)</ion-select-option>\\n            <ion-select-option value=\\\"Origen\\\">Origen (norteamericano, manga, europeo...</ion-select-option>\\n            <ion-select-option value=\\\"ISBNComic\\\">ISBN</ion-select-option>\\n            <ion-select-option value=\\\"EditorialComic\\\">Editorial</ion-select-option>\\n            <ion-select-option value=\\\"IdiomaComic\\\">Idioma</ion-select-option>\\n            <ion-select-option value=\\\"FormatoComic\\\">Formato (físico/digital)</ion-select-option>\\n            <ion-select-option value=\\\"NroComic\\\">Número</ion-select-option>\\n          </div>\\n        </ion-select>\\n        <ion-input placeholder=\\\"Valor\\\" formControlName=\\\"valor\\\" type=\\\"text\\\"></ion-input>\\n        <ion-button shape=\\\"round\\\" color=\\\"primary\\\" type=\\\"submit\\\">Añadir</ion-button>\\n      </ion-item>\\n    <ion-item lines=\\\"full\\\" *ngIf=\\\"criteria.length<1\\\">No hay criterios de búsqueda.</ion-item>\\n    <ion-item lines=\\\"full\\\" *ngIf=\\\"criteria.length>=1\\\">\\n      <ion-chip *ngFor=\\\"let a of criteria\\\">{{a.campo}} = {{a.valor}}<button ion-button (click)=\\\"removeCriteria(a)\\\">x</button></ion-chip>\\n    </ion-item>\\n  </ion-list>\\n  <ion-button expand=\\\"block\\\" shape=\\\"round\\\" color=\\\"primary\\\" (click)=\\\"process()\\\">Aceptar</ion-button>\\n  <ion-list *ngIf=\\\"numres!==null\\\">\\n    <ion-item lines=\\\"full\\\"><small>Mostrando {{numres}} resultados.</small></ion-item>\\n    <ion-item-sliding *ngFor=\\\"let ed of items\\\">\\n      <app-edition-list [ed]=\\\"ed\\\"></app-edition-list>\\n    </ion-item-sliding>\\n  </ion-list>\\n</form>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SearchPage } from './search.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SearchPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SearchPageRoutingModule } from './search-routing.module';\n\nimport { SearchPage } from './search.page';\nimport { ComponentsModule } from '../components/components.module'\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    ComponentsModule,\n    SearchPageRoutingModule\n  ],\n  declarations: [SearchPage]\n})\nexport class SearchPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3NlYXJjaC9zZWFyY2gucGFnZS5zY3NzIn0= */\";","import { Component, OnInit } from '@angular/core';\nimport { Router, ActivatedRoute, NavigationExtras } from '@angular/router';\nimport { NavController } from '@ionic/angular';\nimport { ApiRestService } from '../api-rest.service';\nimport { FormGroup, FormControl, FormBuilder, Validators } from \"@angular/forms\";\nimport { findIndex } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.page.html',\n  styleUrls: ['./search.page.scss'],\n})\nexport class SearchPage implements OnInit {\n\n  items: any[];\n  type: any;\n  criteria: any[] = [];\n  numres = null;\n  isSubmitted = false;\n  formcriteria = null;\n\n  constructor(public http: ApiRestService, private navCtrl: NavController, private route: ActivatedRoute, \n    private router: Router, private formBuilder: FormBuilder) {\n      this.formcriteria= new FormGroup({\n        tipo: new FormControl,\n        campo: new FormControl(),\n        valor: new FormControl()\n     });\n  }\n\n  ngOnInit() {\n    this.formcriteria = this.formBuilder.group({\n      'tipo' : [null],\n      'campo' : [null, Validators.required],\n      'valor' : [null, Validators.required]\n    });\n  }\n\n  addCriteria() {\n    this.isSubmitted = true;\n    if (!this.formcriteria.valid) {\n      console.log('Please provide all the required values!')\n      return false;\n    } else if(this.formcriteria.value['valor']) {\n      var i = this.criteria.find(e => e['campo'] === this.formcriteria.value['campo']);\n      if(!i) {\n        var p = {\n          \"campo\": this.formcriteria.value['campo'],\n          \"valor\": this.formcriteria.value['valor']\n        };\n        this.criteria.push(p);\n      } else {\n        i['valor'] = this.formcriteria.value['valor'];\n      }\n      console.log(\"criteria:\"+this.criteria);\n    }\n  }\n\n  removeCriteria(a: any) {\n    this.criteria.splice(this.criteria.findIndex(e => e === a), 1);\n    console.log(\"people:\"+this.criteria);\n  }\n\n  changeType() {\n    if(this.criteria.find(o => o['campo'] === \"ItemType\")) {\n      this.criteria.splice(this.criteria.findIndex(o => o['campo'] === \"ItemType\"), 1);\n    }\n    if(this.formcriteria.value['tipo']!==\"all\") {\n      var p = {\n        \"campo\": \"ItemType\",\n        \"valor\": this.http.getItemType(this.formcriteria.value['tipo'])\n      };\n      this.criteria.push(p);\n    }\n  }\n\n  get errorControl() {\n    return this.formcriteria.controls;\n  }\n\n  compareFn(e1: any, e2: any): boolean {\n    return e1 && e2 ? e1.id === e2.id : e1 === e2;\n  }\n\n  process() {\n    var c = {\"body\": this.criteria};\n    console.log(\"c \",c);\n    this.http.searchEditions(c).subscribe(\n      (res) => { \n        this.items = res['body']['body'];\n        this.numres = res['itemCount'] || res['body']['itemCount'];\n        console.log(this.numres);\n      },\n      (error) =>{\n        console.error(error);\n        this.numres = 0;\n      }\n    );\n  }\n\n}\n"]}